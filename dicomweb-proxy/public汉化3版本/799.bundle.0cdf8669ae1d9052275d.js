"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[799],{91799:function(e,t,n){n.r(t);var r=n(32735),a=n(60216),i=n.n(a),o=n(72928),l=n(84334),s=n(11429),c=n(38942),u=n(509),m=n(76467),f=n(12200),d=n(18699);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(this,arguments)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=o.ZP.formatDate;function b(e){e.children;var t=e.displaySets,n=e.viewportIndex,a=e.viewportLabel,i=e.servicesManager,o=e.extensionManager,g=e.commandsManager,b=e.viewportOptions,h=((0,c.$G)("TrackedViewport").t,i.services),S=h.MeasurementService,w=h.CornerstoneViewportService,E=t[0],x=v((0,d.I)(),1)[0],C=v((0,s.O_)(),1)[0].activeViewportIndex,P=v((0,s.vQ)(),2),N=P[0],k=N.isCineEnabled,I=N.cines,A=P[1],M=v((0,s.en)(),1)[0],O=v((0,r.useState)(!1),2),T=O[0],D=O[1],R=v((0,r.useState)(null),2),j=R[0],V=R[1],Z=v((0,r.useState)(null),2),F=Z[0],_=Z[1],K=x.context.trackedSeries,W=b.viewportId,q=(E.Modality,E.SeriesDate),L=E.SeriesDescription,U=E.SeriesInstanceUID,J=E.SeriesNumber,$=E.images[0],B=$.PatientID,G=$.PatientName,Q=$.PatientSex,Y=$.PatientAge,z=$.SliceThickness,H=$.SpacingBetweenSlices,X=$.ManufacturerModelName,ee=function(){if(I&&I[n]&&F){var e=I[n],t=e.isPlaying||!1,r=e.frameRate||24,a=Math.max(r,1);t?A.playClip(F,{framesPerSecond:a}):A.stopClip(F)}};(0,r.useEffect)((function(){return T?(f.Z.setViewportToolStyles(W,{global:{lineDash:""}}),void w.getRenderingEngine().renderViewport(W)):(f.Z.setViewportToolStyles("viewport-".concat(n),{global:{lineDash:"4,4"}}),w.getRenderingEngine().renderViewport(W),function(){f.Z.setViewportToolStyles(W,{})})}),[T]),(0,r.useEffect)((function(){return u.Z.addEventListener(m.Z.STACK_VIEWPORT_NEW_STACK,ee),function(){A.setCine({id:n,isPlaying:!1}),u.Z.removeEventListener(m.Z.STACK_VIEWPORT_NEW_STACK,ee)}}),[F]),(0,r.useEffect)((function(){if(I&&I[n]&&F)return ee(),function(){var e;F&&null!=I&&null!==(e=I[n])&&void 0!==e&&e.isPlaying&&A.stopClip(F)}}),[I,n,A,F,ee]),K.includes(U)!==T&&D(!T);var te=function(e){_(e.detail.element)};var ne,re=I[n],ae=re&&re.isPlaying||!1;return r.createElement(r.Fragment,null,r.createElement(s.uY,{onDoubleClick:function(e){e.stopPropagation(),e.preventDefault()},useAltStyling:T,onArrowsClick:function(e){return function(e){var t=function(e,t,n,r){var a=t.services.MeasurementService.getMeasurements(),i=r.context.trackedSeries,o=a.filter((function(e){return i.includes(e.referenceSeriesUID)}));if(o.length){var l=o.length,s=o.map((function(e){return e.uid})),c=s.findIndex((function(e){return e===n}));return-1===c?c=0:"left"===e?--c<0&&(c=l-1):"right"===e&&++c===l&&(c=0),s[c]}}(e,i,j,x);t&&(V(t),S.jumpToMeasurement(n,t))}(e)},getStatusComponent:function(){return function(e){var t=e?"tracked":"dotted-circle";return r.createElement("div",{className:"relative"},r.createElement(s.u,{position:"bottom-left",content:r.createElement("div",{className:"flex py-2"},r.createElement("div",{className:"flex pt-1"},r.createElement(s.JO,{name:"info-link",className:"w-4 text-primary-main"})),r.createElement("div",{className:"flex ml-4"},r.createElement("span",{className:"text-base text-common-light"},e?r.createElement(r.Fragment,null,"Series is",r.createElement("span",{className:"font-bold text-white"}," tracked")," and can be viewed ",r.createElement("br",null)," in the measurement panel"):r.createElement(r.Fragment,null,"Measurements for",r.createElement("span",{className:"font-bold text-white"}," untracked "),"series ",r.createElement("br",null)," will not be shown in the ",r.createElement("br",null)," measurements panel"))))},r.createElement(s.JO,{name:t,className:"w-6 text-primary-light"})))}(T)},studyData:{label:a,studyDate:y(q),currentSeries:J,seriesDescription:L,patientInformation:{patientName:G?l.ZP.utils.formatPN(G.Alphabetic):"",patientSex:Q||"",patientAge:Y||"",MRN:B||"",thickness:z?"".concat(parseFloat(z).toFixed(2),"mm"):"",spacing:void 0!==H?"".concat(parseFloat(H).toFixed(2),"mm"):"",scanner:X||""}},showNavArrows:!k,showCine:k,cineProps:{isPlaying:ae,onClose:function(){return g.runCommand("toggleCine")},onPlayPauseChange:function(e){return A.setCine({id:C,isPlaying:e})},onFrameRateChange:function(e){return A.setCine({id:C,frameRate:e})}}}),r.createElement("div",{className:"relative flex flex-row w-full h-full overflow-hidden"},(ne=o.getModuleEntry("@ohif/extension-cornerstone.viewportModule.cornerstone").component,r.createElement(ne,p({},e,{onElementEnabled:te}))),r.createElement("div",{className:"absolute w-full"},M.viewportIndex===n&&r.createElement(s.P_,{id:M.id,message:M.message,type:M.type,actions:M.actions,onSubmit:M.onSubmit,onOutsideClick:M.onOutsideClick}))))}b.propTypes={displaySets:i().arrayOf(i().object.isRequired).isRequired,viewportIndex:i().number.isRequired,dataSource:i().object,children:i().node,customProps:i().object},b.defaultProps={customProps:{}},t.default=b}}]);
//# sourceMappingURL=799.bundle.0cdf8669ae1d9052275d.js.map